<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ù†ØªÛŒÙ†Ø± â€“ <%= company %></title>
  <link href="/fonts/font.css" rel="stylesheet" />
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <button class="theme-toggle" id="themeToggle" aria-pressed="false" aria-label="ØªØºÛŒÛŒØ± ØªÙ…" title="ØªØºÛŒÛŒØ± ØªÙ…">
  <!-- Sun (Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ø¯Ø§Ø±Ú© Ù…ÙˆØ¯) -->
  <span class="icon sun" aria-hidden="true">
    <!-- Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø§ÛŒÙ†Ø¬Ø§ SVG Ù‚Ø±Ø§Ø± Ø¨Ø¯ÛŒØ› emoji Ù‡Ù… Ø®ÙˆØ¨Ù‡ -->
    â˜€ï¸
  </span>

  <!-- Moon (Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù„Ø§ÛŒØª Ù…ÙˆØ¯) -->
  <span class="icon moon" aria-hidden="true">
    ğŸŒ™
  </span>

  <!-- Ù…ØªÙ† -->
  <span class="label" aria-live="polite">Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©</span>
</button>


  <div class="container">
    <h2>Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ù†ØªÛŒÙ†Ø± â€“ <%= company %></h2>
    <button>Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯: <a href="/users">Ø«Ø¨Øª</a></button>
    <p>Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ <a><%= username %></a> </p> 
    <button><a href="/logout">Ø®Ø±ÙˆØ¬</a></button>

    <form method="POST" action="/add">
      <input name="owner" placeholder="ØµØ§Ø­Ø¨ Ú©Ø§Ù„Ø§"required>
      <input name="entry_date" placeholder="ØªØ§Ø±ÛŒØ® ÙˆØ±ÙˆØ¯"required>
      <input name="entry_driver_name" placeholder="Ø±Ø§Ù†Ù†Ø¯Ù‡ ÙˆØ±ÙˆØ¯"required>
      <input name="entry_phone" placeholder="Ù…ÙˆØ¨Ø§ÛŒÙ„ ÙˆØ±ÙˆØ¯"required>
      <input name="exit_date" placeholder="ØªØ§Ø±ÛŒØ® Ø®Ø±ÙˆØ¬"required>
      <input name="exit_driver_name" placeholder="Ø±Ø§Ù†Ù†Ø¯Ù‡ Ø®Ø±ÙˆØ¬"required>
      <input name="exit_phone" placeholder="Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø®Ø±ÙˆØ¬"required>
      <input name="type" placeholder="Ù†ÙˆØ¹ Ú©Ø§Ù†ØªÛŒÙ†Ø±"required>
      <input name="container_no" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ù†ØªÛŒÙ†Ø±"required>
      <button type="submit">Ø«Ø¨Øª</button>
    </form>

    <h3>Ù„ÛŒØ³Øª Ú©Ø§Ù†ØªÛŒÙ†Ø±Ù‡Ø§</h3>
    <input type="text" id="search" placeholder="Ø¬Ø³ØªØ¬Ùˆ..." onkeyup="searchTable()">

    <table id="containerTable">
      <thead>
       <tr>
         <th>Ø´Ù…Ø§Ø±Ù‡</th>
         <th>ØµØ§Ø­Ø¨ Ú©Ø§Ù„Ø§</th>
         <th>ØªØ§Ø±ÛŒØ® ÙˆØ±ÙˆØ¯</th>
         <th>Ø±Ø§Ù†Ù†Ø¯Ù‡ ÙˆØ±ÙˆØ¯</th>
         <th>Ù…ÙˆØ¨Ø§ÛŒÙ„ ÙˆØ±ÙˆØ¯</th>
         <th>ØªØ§Ø±ÛŒØ® Ø®Ø±ÙˆØ¬</th>
         <th>Ø±Ø§Ù†Ù†Ø¯Ù‡ Ø®Ø±ÙˆØ¬</th>
         <th>Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø®Ø±ÙˆØ¬</th>
         <th>Ù†ÙˆØ¹</th>
         <th>Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ù†ØªÛŒÙ†Ø±</th>
         <th>ÙØ§Ú©ØªÙˆØ±</th>
         <th>Ø«Ø¨Øªâ€ŒÚ©Ù†Ù†Ø¯Ù‡</th>

       </tr>
      </thead>
      <tbody>

      <% let count = 1; %>
      <% containers.forEach(row => { %>
      <tr>
        <td><%= count++ %></td>
        <td><%= row.owner %></td>
        <td><%= row.entry_date %></td>
        <td><%= row.driver_name %></td>
        <td><%= row.entry_phone %></td>
        <td><%= row.exit_date %></td>
        <td><%= row.exit_driver_name %></td>
        <td><%= row.exit_phone %></td>
        <td><%= row.type %></td>
        <td><%= row.container_no %></td>
        <td><a href="/invoice/<%= row.id %>" target="_blank">Ø¯Ø§Ù†Ù„ÙˆØ¯</a></td>
        <td><%= row.created_by_user || "-" %></td>
      </tr>
      <% }) %>
     <tbody>
   </table>
  </div>
  

<script>
  (function(){
    const btn = document.getElementById('themeToggle');
    const body = document.body;
    const label = btn.querySelector('.label');

    // init: Ø§Ø² localStorage ÛŒØ§ prefers-color-scheme
    const saved = localStorage.getItem('theme');
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

    if (saved === 'dark' || (!saved && prefersDark)) {
      body.classList.add('dark-mode');
      btn.setAttribute('aria-pressed', 'true');
      if(label) label.textContent = 'Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†';
    } else {
      body.classList.remove('dark-mode');
      btn.setAttribute('aria-pressed', 'false');
      if(label) label.textContent = 'Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©';
    }

    btn.addEventListener('click', function() {
      const isDark = body.classList.toggle('dark-mode');
      btn.setAttribute('aria-pressed', String(isDark));
      localStorage.setItem('theme', isDark ? 'dark' : 'light');

      if(label) {
        // Ù…ØªÙ† Ø¨Ø§ ÛŒÚ© Ø§ÙÚ©Øª Ù†Ø±Ù… Ø¹ÙˆØ¶ Ø´ÙˆØ¯
        label.style.opacity = 0;
        setTimeout(() => {
          label.textContent = isDark ? 'Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†' : 'Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©';
          label.style.opacity = 1;
        }, 180);
      }
    });

    // Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± ØªÙ†Ø¸ÛŒÙ… Ø³ÛŒØ³ØªÙ… Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ø§Ø¯ØŒ Ù‡Ù…Ø®ÙˆØ§Ù† Ú©Ù† (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
    if(window.matchMedia){
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
        // ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±ØªÛŒ sync Ú©Ù† Ú©Ù‡ Ú©Ø§Ø±Ø¨Ø± ØªØ§Ú©Ù†ÙˆÙ† ØªØºÛŒÛŒØ±ÛŒ Ù†Ø¯Ø§Ø¯Ù‡ (localStorage Ø®Ø§Ù„ÛŒ)
        if(!localStorage.getItem('theme')){
          if(e.matches){ body.classList.add('dark-mode'); btn.setAttribute('aria-pressed','true'); if(label) label.textContent='Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†'; }
          else { body.classList.remove('dark-mode'); btn.setAttribute('aria-pressed','false'); if(label) label.textContent='Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©'; }
        }
      });
    }
  })();
</script>


  <script>
    function searchTable() {
      let q = document.getElementById("search").value.toLowerCase();
      let rows = document.querySelectorAll("#containerTable tbody tr");
      for (let i = 0; i < rows.length; i++) {
        let text = rows[i].innerText.toLowerCase();
        rows[i].style.display = text.includes(q) ? "" : "none";
      }
    }
  </script>

</body>
</html>
